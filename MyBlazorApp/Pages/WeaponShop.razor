@page "/weaponshop"

<h1>武器商</h1>

<ul>
    <li><a href="#" @onclick="() => ForgeItem(5, 1)">鍛造鎧甲</a></li>
    <li><a href="#" @onclick="() => ForgeItem(10, 2)">鍛造武器</a></li>
</ul>

<p>玩家金幣：@Player.Coins</p>

@if (errorMessage != null)
{
    <p>@errorMessage</p>
}

<button @onclick="GoBack">離開商店</button>

@code {
    [Inject]
    private Player Player { get; set; }

    private string errorMessage;
    [Inject]
    private NavigationManager navigationManager { get; set; }

    private void ForgeItem(int cost, int statType)
    {
        if (Player.Coins >= cost)
        {
            Player.Coins -= cost;
            if (statType == 1)
            {
                Player.Defense += 1;
            }
            else if (statType == 2)
            {
                Player.Attack += 1;
            }
            errorMessage = null; // 重置錯誤訊息
        }
        else
        {
            errorMessage = "金幣不足";
        }
    }

    private void GoBack()
    {
        navigationManager.NavigateTo("/town");
    }
}
